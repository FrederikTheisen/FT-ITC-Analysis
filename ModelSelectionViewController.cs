// This file has been autogenerated from a class added in the UI designer.

using System;

using Foundation;
using AppKit;
using CoreGraphics;

namespace AnalysisITC
{
	public partial class ModelSelectionViewController : NSViewController
	{
        public static AnalysisModel SelectedModel => DataAnalysisViewController.SelectedAnalysisModel;

		public ModelSelectionViewController (IntPtr handle) : base (handle)
		{
		}

        public override void ViewDidLoad()
        {
            base.ViewDidLoad();

            foreach (var type in AnalysisModelAttribute.GetAll())
            {
                var att = type.GetProperties();

                var valid = AppClasses.Analysis2.ModelFactory.InitializeFactory(type, false) != null;

                var btn = new NSButton(new CGRect(0, 0, 100, 19))
                {
                    Title = att.Name,
                    ToolTip = att.Description,
                    BezelStyle = NSBezelStyle.Recessed,
                    State = type == SelectedModel ? NSCellStateValue.On : NSCellStateValue.Off,
                    Enabled = valid,
                };
                btn.Cell.ShowsStateBy = 12;
                btn.Activated += BtnClickHandler;
                btn.Activated += (o, e) => { DataAnalysisViewController.SelectedAnalysisModel = type; };

                StackView.AddArrangedSubview(btn);
            }
        }

        void DeselectAll()
        {
            foreach (var view in this.View.Subviews[0].Subviews)
            {
                if (view is NSButton)
                {
                    ((NSButton)view).State = NSCellStateValue.Off;
                }
            }
        }

        void BtnClickHandler(object sender, EventArgs e)
        {
            DeselectAll();

            (sender as NSButton).State = NSCellStateValue.On;
        }
    }
}
